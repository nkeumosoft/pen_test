{% extends 'admin/model/edit.html' %}
{% block head %}

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>

{% endblock %}

{% block body %}


    <form method="post">
        <table class="table" id="data_list">
            <thead class="thead-dark">
            <tr>
                <th scope="col"> #</th>
                <th scope="col"> Select</th>
                <th scope="col">name</th>
                <th scope="col">Url</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            {% if error_forms %}
                <tr>
                    <td colspan="4"><h1 class="btn btn-danger justify-content-center text-center">{{ error_forms }}</h1>
                    </td>
                </tr>
            {% endif %}
            {% for website in websites %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <th scope="row">
                        <input type="checkbox" name="checked" value="{{ website.url }}">
                    </th>
                    <td>{{ website.name }}</td>
                    <td><a href="{{ website.url }}">{{ website.url }}</a></td>
                    <td>
                        <a href="{{ url_for( 'admin.result', key=website.id  ) }}"
                           class="btn btn-success">
                            Run</a>
                    </td>

                </tr>
            {% endfor %}
            <tr>
                <td colspan="4">
                    <button type="submit" class="btn btn-success justify-content-center text-center">Run All selected
                    </button>
                </td>
            </tr>
            </tbody>
        </table>

    </form>

    <script>
        $(document).ready(function () {


            $('#data_list').after('<nav aria-label="..."><ul class="pagination" id="nav"></ul></nav>');
                let row_to_display = 15;
                let total_row = $('#data_list tbody tr').length;
                let number_of_pages = total_row/row_to_display;
                for(let i = 0;i < number_of_pages; i++) {
                    let  page_index = i + 1;
                    $('#nav').append('<li id="ul_nav" class="page-item"><a  class="page-link" href="#" rel="'+i+'">'+page_index+'</a></li>');
                }
                $('#data_list tbody tr').hide();
                $('#data_list tbody tr').slice(0, row_to_display).show();
                $('#ul_nav  a:first').addClass('active');
                $('#ul_nav a').bind('click', function(){

                    $('#ul_nav  a').removeClass('active');
                    $(this).addClass('active');
                    let current_page = $(this).attr('rel');
                    let start_index = current_page * row_to_display;
                    let index_of_end = start_index + row_to_display;
                    $('#data_list tbody tr').css('opacity','0.0').hide().slice(start_index, index_of_end).
                    css('display','table-row').animate({opacity:1}, 300);
                });

        });


    </script>

{% endblock %}