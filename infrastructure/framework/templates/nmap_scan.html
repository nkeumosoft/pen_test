{% extends 'admin/master.html' %}
{% import "bootstrap/wtf.html" as wtf %}
{% block head %}

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/css/bootstrap-select.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.2/js/bootstrap-select.min.js"></script>


{#    <link rel="stylesheet"#}
{#          href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">#}
{##}
{#    <!-- jQuery -->#}
{#    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>#}
{#    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>#}
    <style>

        .fakeScreen {
          background-color: #151515;
          box-sizing: border-box;
          width: 100%;
          margin: 0 auto;
          padding: 20px;
          border-bottom-left-radius: 5px;
          border-bottom-right-radius: 5px;
        }

        p {
          position: relative;
          text-align: left;
          font-size: 1.25em;
          font-family: monospace;
          white-space: normal;
          overflow: hidden;
          width: 0;
        }



        .line1 {
          color: #9CD9F0;
          -webkit-animation: type .5s 1s steps(20, end) forwards;
          -moz-animation: type .5s 1s steps(20, end) forwards;
          -o-animation: type .5s 1s steps(20, end) forwards;
          animation: type .5s 1s steps(20, end) forwards;
        }

        .cursor1 {
          -webkit-animation: blink 1s 2s 2 forwards;
          -moz-animation: blink 1s 2s 2 forwards;
          -o-animation: blink 1s 2s 2 forwards;
          animation: blink 1s 2s 2 forwards;
        }

        .line2 {
          color: #CDEE69;
          -webkit-animation: type .5s 4.25s steps(20, end) forwards;
          -moz-animation: type .5s 4.25s steps(20, end) forwards;
          -o-animation: type .5s 4.25s steps(20, end) forwards;
          animation: type .5s 4.25s steps(20, end) forwards;
        }

        .cursor2 {
          -webkit-animation: blink 1s 5.25s 2 forwards;
          -moz-animation: blink 1s 5.25s 2 forwards;
          -o-animation: blink 1s 5.25s 2 forwards;
          animation: blink 1s 5.25s 2 forwards;
        }



        @-webkit-keyframes blink {
          0% {
            opacity: 0;
          }
          40% {
            opacity: 0;
          }
          50% {
            opacity: 1;
          }
          90% {
            opacity: 1;
          }
          100% {
            opacity: 0;
          }
        }

        @-moz-keyframes blink {
          0% {
            opacity: 0;
          }
          40% {
            opacity: 0;
          }
          50% {
            opacity: 1;
          }
          90% {
            opacity: 1;
          }
          100% {
            opacity: 0;
          }
        }

        @-o-keyframes blink {
          0% {
            opacity: 0;
          }
          40% {
            opacity: 0;
          }
          50% {
            opacity: 1;
          }
          90% {
            opacity: 1;
          }
          100% {
            opacity: 0;
          }
        }

        @keyframes blink {
          0% {
            opacity: 0;
          }
          40% {
            opacity: 0;
          }
          50% {
            opacity: 1;
          }
          90% {
            opacity: 1;
          }
          100% {
            opacity: 0;
          }
        }

        @-webkit-keyframes type {
          to {
            width: 17em;
          }
        }

        @-moz-keyframes type {
          to {
            width: 17em;
          }
        }

        @-o-keyframes type {
          to {
            width: 17em;
          }
        }

        @keyframes type {
          to {
            width: 17em;
          }
        }
    </style>
{% endblock %}
{% block body %}

    <div class="container-fluid">

        <form method="post" id="nmap_scan" >

            <table class="table">
                <thead class="thead-dark">
                <tr>

                    <th scope="col" style="width:50%">name</th>
                    <th scope="col" style="width:15%">port</th>
                    <th scope="col">Scan argument</th>

                </tr>
                </thead>
                <tbody>
                {% if error_forms %}
                    <tr>
                        <td colspan="4"><h1
                                class="btn btn-danger justify-content-center text-center">{{ error_forms }}</h1>
                        </td>
                    </tr>
                {% endif %}


                <tr>

                    <td>
                        <label for="cars">Find your Website:</label>

                        <select id="cars" class="selectpicker" name="website_name" title="Choose Or Find Your Url..." data-live-search="true">
                            {% for website in websites %}
                                <option data-tokens="{{ website.id }}" value="{{ website.id }}">{{ website.url }}</option>
                            {% endfor %}

                        </select>
                    </td>
                    <td>
                        <div class="form-group "><label class="form-control-label" for="start_port">Start
                            Port</label>
                            <input class="form-control" type="number" style="width: 50px">
                        </div>
                        <div class="form-group "><label class="form-control-label" for="end_port" >End Port</label>

                            <input class="form-control" type="number" style="width: 50px">

                        </div>

                    </td>
                    {# argument for scan nmap #}
                    <td>
                        <ul class="list-group">
                            <li class="list-group-item">
                                <label for="normal">Normal</label>
                                <input type="radio" id="normal" onclick="toggle_hide()" value="yes" name="normalScan" checked="">
                            </li>
                            <li class="list-group-item">
                                <label for="advance-scan">Advance</label>
                                <input type="radio" id="advance-scan" onclick="toggle()" value="no" name="normalScan">
                                <div id="myDIV" style="display: none">
                                <div id="portscan-advance" class="list-group">
                                        <div id="portscan-scanoptions" class="list-group">
                                            <div id="portscan-label">Scan Type:</div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="connect" id="connect" name="scan_type" checked="">
                                                <label for="connect">connect()</label>
                                            </div>
                                             <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="udp_scan" id="syn" name="scan_type">
                                                <label for="syn">UDP Scan</label>
                                            </div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="syn" id="syn" name="scan_type">
                                                <label for="syn">SYN Stealth</label>
                                            </div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="null" id="null" name="scan_type">
                                                <label for="null">NULL Stealth</label>
                                            </div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="fin" id="fin" name="scan_type">
                                                <label for="fin">FIN Stealth</label>
                                            </div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="xmas" id="xmas" name="scan_type">
                                                <label for="xmas">XMAS Scan</label>
                                            </div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="ack" id="ack" name="scan_type">
                                                <label for="ack">ACK Scan</label>
                                            </div>
                                            <div id="portscan-scanoption" class="list-group-item">
                                                <input type="radio" value="window" id="window" name="scan_type">
                                                <label for="window">Window Scan</label>
                                            </div>
                                        </div>
                                        <div id="portscan-generaloptions" class="list-group">
                                            <div id="portscan-label">Ping Type:</div>
                                            {% for key, value in ping_options.items() %}
                                                <div id="portscan-scanoption" class="list-group-item">
                                                    <input type="radio" id="tcp_icmp" value="{{ value }}" name="ping_type" checked="">
                                                    <label for="tcp_icmp">{{ key }}</label>
                                                </div>
                                            {% endfor %}

                                            <div id="portscan-scanoption" class="list-group-item"><input type="radio" id="icmp" value="icmp" name="ping_type"><label for="icmp">ICMP</label></div>
                                            <div id="portscan-scanoption" class="list-group-item"><input type="radio" id="tcp" value="tcp" name="ping_type"><label for="tcp">TCP</label></div>
                                            <div id="portscan-scanoption" class="list-group-item"><input type="radio" id="none" value="none" name="ping_type" checked=""><label for="none">Don't Ping</label></div>
                                            <div style="clear: both;"></div>

                                        </div>
                                    <div id="portscan-label">General Options:</div>
                                    <ul class="list-group">
                                                    {% for key, value in arguments.items() %}

                                                        <li class="list-group-item">
                                                            <input type="checkbox" name="g_options" value="{{ value }}"> {{ key }}
                                                        </li>
                                                    {% endfor %}
                                                </ul>
                                    </div>

                                </div>
                            </li>

                        </ul>

                    </td>

                </tr>

                <tr>
                    <td colspan="4">
                        <button type="submit"  id="send" class="btn btn-success justify-content-center text-center">Run Scan
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
             <div class="error"></div>
        </form>
    {% if info_scan %}
        <div class="result">
            <div class="fakeScreen">
                <p class="line1">$ {{ cmd }}<span class="cursor1">_</span></p>
                {%  for key,value in stats.items() %}
                    <p class="line1">$ {{ key }}: {{ value }}<span class="cursor1">_</span></p>
                {% endfor %}


                {%  for key, key_parent in info_scan.items() %}
                    {%  for key , value in key_parent.items() %}
                        <p class="line2">$ {{ key }}: {{ value }}<span class="cursor2">_</span></p>
                    {% endfor %}

                {% endfor %}

            {% if  port_found %}
                <table class="table table-light" value="{{ len_of_table }}"  id="data_list" style="width: 100%">
                     <thead class="thead-dark">
                        <tr>
                            <th scope="col">port </th>
                            <th scope="col">state </th>
                            <th scope="col">reason </th>
                             <th scope="col">name </th>
                            <th scope="col">product </th>
                            <th scope="col">version </th>
                            <th scope="col">extra_info </th>
                            <th scope="col" >conf </th>
                            <th scope="col">cpe </th>

                        </tr>
                     </thead>
                    <tbody>

                        {%  for key, key_parent in port_found.items() %}
                            <tr>
                                <td>{{ key }}</td>
                                {%  for key_child , value in key_parent.items() %}
                                        <td>{{ value }}</td>
                                {% endfor %}
                            </tr>
                    {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p class="line2">$ port not Found ...<span class="cursor2">_</span></p>
            {% endif %}

                    {%  for key , value in host_name.items() %}
                        <p class="line2">$ {{ key }}: {{ value }}<span class="cursor2">_</span></p>
                    {% endfor %}


                    {%  for key , value in status.items() %}
                        <p class="line2">$ {{ key }}: {{ value }}<span class="cursor2">_</span></p>
                    {% endfor %}
                    {%  for key , value in vendor.items() %}
                        <p class="line2">$ {{ key }}: {{ value }}<span class="cursor2">_</span></p>
                    {% endfor %}


            </div>
        </div>




        {% endif %}
    </div>
    <!-- Latest compiled and minified JavaScript -->


    <script>


        function pagination(){


        }
        function toggle() {
          let x = document.getElementById("myDIV");

          if (x.style.display === "none") {
            x.style.display = "block";

          }
        }

        function toggle_hide(){
            let x = document.getElementById("myDIV");
              if (x.style.display === "block") {
                x.style.display = "none";
              }
        }


        form_send = document.querySelector('#send');
        form_send.addEventListener('submit', (onsubmit) => {
            console.log(form_send)
            return false;
        });

        function check_form() {



                console.log(form_send)
                if (what.selectedIndex === -1) {
                    alert("Please enter your course.");
                    what.focus();
                    return false;
                }

                return true;
            }
             $(document).ready(function () {


            $('#data_list').after('<nav aria-label="..."><ul class="pagination" id="nav"></ul></nav>');
                let row_to_display = 15;
                let total_row = $('#data_list tbody tr').length;
                let number_of_pages = total_row/row_to_display;
                for(let i = 0;i < number_of_pages; i++) {
                    let  page_index = i + 1;
                    $('#nav').append('<li id="ul_nav" class="page-item"><a  class="page-link" href="#" rel="'+i+'">'+page_index+'</a></li>');
                }
                $('#data_list tbody tr').hide();
                $('#data_list tbody tr').slice(0, row_to_display).show();
                $('#ul_nav  a:first').addClass('active');
                $('#ul_nav a').bind('click', function(){

                    $('#ul_nav  a').removeClass('active');
                    $(this).addClass('active');
                    let current_page = $(this).attr('rel');
                    let start_index = current_page * row_to_display;
                    let index_of_end = start_index + row_to_display;
                    $('#data_list tbody tr').css('opacity','0.0').hide().slice(start_index, index_of_end).
                    css('display','table-row').animate({opacity:1}, 300);
                });
            $('select').selectpicker();
        });
    </script>
{% endblock %}
