import abc
from typing import Dict, Optional
from uuid import UUID, uuid4


class IVulnerability(metaclass=abc.ABCMeta):

    @abc.abstractproperty
    def attack_name(self) -> str:
        ...

    @abc.abstractproperty
    def num_vulnerability(self) -> int:
        ...

    @abc.abstractproperty
    def attack_details(self) -> Dict:
        ...

    @abc.abstractproperty
    def uuid(self) -> UUID:
        ...

    @classmethod
    def factory(
            cls, website_id: UUID, name: str, number: int, details: Dict, uuid: Optional[UUID] = None
    ) -> 'IVulnerability':
        uuid = uuid or uuid4()
        return cls(
            uuid,
            website_id,
            name,
            number,
            details
        )

